{
  "id": "infra-k8s-secrets-env-guide",
  "name": "K8s Secrets/ENV 設計ガイド 最小",
  "version": "1.0.0",
  "stack": ["kubernetes", "docs"],
  "tags": ["k8s", "secrets", "env", "docs"],
  "description": "Secret/ConfigMapとDeploymentでのenvFrom/vars設計の最小サンプル＋ガイド。",
  "files": [
    { "path": "k8s/secret.yaml", "template": "apiVersion: v1\nkind: Secret\nmetadata: { name: myapp-secrets }\ntype: Opaque\ndata:\n  DATABASE_URL: ZGJfdXJs\n" },
    { "path": "k8s/configmap.yaml", "template": "apiVersion: v1\nkind: ConfigMap\nmetadata: { name: myapp-config }\ndata:\n  LOG_LEVEL: info\n" },
    { "path": "k8s/deployment.yaml", "template": "apiVersion: apps/v1\nkind: Deployment\nmetadata: { name: myapp }\nspec:\n  replicas: 1\n  selector: { matchLabels: { app: myapp } }\n  template:\n    metadata: { labels: { app: myapp } }\n    spec:\n      containers:\n        - name: app\n          image: nginx:alpine\n          envFrom:\n            - secretRef: { name: myapp-secrets }\n            - configMapRef: { name: myapp-config }\n          env:\n            - name: FEATURE_FLAG\n              value: "enabled"\n" },
    { "path": "docs/k8s-secrets-env.md", "template": "# K8s Secrets/ENV Guide\n\n- Secret: 機微情報（base64エンコード、KMS等での暗号化を併用）\n- ConfigMap: 非機微設定（ログレベル等）\n- Deployment: `envFrom`で一括注入 + 個別`env`で上書き/追加\n- CI: 環境毎にSecret/ConfigMapを切替（preview/prod）\n" }
  ]
}

