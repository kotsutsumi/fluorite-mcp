{
  "id": "pg-copy-from-minimal",
  "name": "pg COPY FROM 最小",
  "version": "1.0.0",
  "stack": ["node", "pg", "postgres"],
  "tags": ["db", "bulk"],
  "description": "pg-copy-streams を用いた COPY FROM STDIN の最小例",
  "params": [ { "name": "table", "default": "items" } ],
  "files": [
    { "path": "pg/copy-from.js", "template": "const { Client } = require('pg');\nconst copyFrom = require('pg-copy-streams').from;\nconst { Readable } = require('stream');\n(async () => {\n  const client = new Client({ connectionString: process.env.DATABASE_URL });\n  await client.connect();\n  const stream = client.query(copyFrom(`COPY {{table}} (id, name) FROM STDIN WITH (FORMAT csv)`));\n  const src = Readable.from(['1,Alice\n','2,Bob\n']);\n  src.pipe(stream).on('finish', async () => { await client.end(); console.log('copied'); });\n})();\n" }
  ]
}

