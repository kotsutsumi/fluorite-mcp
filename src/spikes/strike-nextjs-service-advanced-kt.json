{
  "id": "strike-nextjs-service-advanced-kt",
  "name": "nextjs service advanced kt",
  "version": "0.1.0",
  "stack": [
    "nextjs",
    "kt"
  ],
  "tags": [
    "service",
    "advanced",
    "generated",
    "strike"
  ],
  "description": "Auto-generated spike for nextjs service in kt (advanced).",
  "params": [
    {
      "name": "app_name",
      "default": "nextjs-service-app"
    }
  ],
  "files": [
    {
      "path": "app/actions/demo.ts",
      "template": "'use server';\nexport async function demoAction(){ return { ok: true }; }\n"
    },
    {
      "path": "src/next/response.ts",
      "template": "import { NextResponse } from 'next/server';\nexport type Ok<T> = { ok: true; data: T };\nexport type Err = { ok: false; error: unknown };\nexport function ok<T>(data: T){ return NextResponse.json({ ok: true, data } as Ok<T>); }\nexport function err(e: unknown, status=400){ return NextResponse.json({ ok: false, error: String(e) } as Err, { status }); }\n"
    },
    {
      "path": "app/rsc/page.tsx",
      "template": "export default function Page(){ return <div>Server Component (RSC)</div>; }\n"
    },
    {
      "path": "app/csr/page.tsx",
      "template": "'use client';\nexport default function Page(){ return <div>Client Component (CSR)</div>; }\n"
    },
    {
      "path": "app/api/typed/route.ts",
      "template": "import { z } from 'zod';\nimport { ok, err } from '@/src/next/response';\nconst Payload = z.object({ name: z.string().min(1) });\nexport async function POST(req: Request){ try { const json = await req.json(); const parsed = Payload.parse(json); return ok({ message: 'Hello ' + parsed.name }); } catch(e){ return err(e, 400); } }\n"
    },
    {
      "path": "src/next/withRole.ts",
      "template": "import type { NextRequest } from 'next/server';\nexport function withRole(required: 'user'|'admin', handler: (req: NextRequest)=>Promise<Response>|Response){\n  return async (req: NextRequest) => {\n    const role = (req.headers.get('x-role') as 'user'|'admin') || 'user';\n    if (required === 'admin' && role !== 'admin') {\n      return new Response('Forbidden', { status: 403 });\n    }\n    return handler(req);\n  };\n}\n"
    },
    {
      "path": "src/next/security-headers.ts",
      "template": "export const securityHeaders = [\n  { key: 'X-Frame-Options', value: 'DENY' },\n  { key: 'X-Content-Type-Options', value: 'nosniff' },\n  { key: 'Referrer-Policy', value: 'strict-origin-when-cross-origin' }\n];\n"
    },
    {
      "path": "spikes/strike-nextjs-service-advanced-kt.kt.txt",
      "template": "# Spike: nextjs service (kt)\n// Auto-generated spike stub for nextjs (service)\nfun demo(){ println(\"use nextjs - service (advanced)\") }\n"
    },
    {
      "path": "spikes/strike-nextjs-service-advanced-kt.md",
      "template": "# nextjs service (advanced, kt)\n\nThis is an auto-generated spike template.\n"
    }
  ],
  "patches": []
}
